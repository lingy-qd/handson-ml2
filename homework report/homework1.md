<center><font size=5>第一次作业</font></center>
<center><font size=5>软件学院 林耕宇 SA22225093</font></center>

&nbsp;

1、问题设定。通过沟通确定了业务目标，明确了要解决的问题属于回归问题，并选择了相应的性能衡量指标。本章中，所使用的性能衡量指标是什么？

在本章中所使用的性能衡量指标是均方根误差（RMSE），均方根误差测量的是系统预测误差的标准差。
$$
RMSE(X,h)=\sqrt{\frac{1}{m}\sum_{i=1}^m(h(x^{(i)})-y^{(i)})^2}
$$


2、获取数据。假定数据集已下载到本地:

（1）如何加载数据集？请写出相应的代码。

数据集以csv文件保存在本地，加载方式如下：
```python
def load_housing_data(housing_path=HOUSING_PATH):  
    csv_path = os.path.join(housing_path, "housing.csv")
    return pd.read_csv(csv_path)
housing = load_housing_data()
```
（2）数据集的总行数是？每个属性的类型是？哪个属性存在缺失值？

``housing.shape``查看housing的尺寸为(20640, 10)，可知总行数为20640

通过``housing.info()``查看属性的类型和缺失值情况，如下所示：
图片.png
（3）数据集中的ocean_proximity属性为非数值属性，其取值情况有哪几种？
（4）如何查看数据集中所有数值型属性的平均值，最大值和最小值。
（5）如何查看数据集中所有数值型属性的直方图？观察直方图，如何判断某个属性的取值被设定了上限？直方图中的“重尾”是指什么？发现重尾现象，需要进行处理吗？
（6）创建测试集时，通常有哪两类抽样方式？本章中哪种抽样方式更好？为什么？
&nbsp;

3、研究数据。
（1）我们需要对测试集中的样本进行研究吗？为什么？
（2）通过探寻属性之间的相关性，可以找出最重要的特征。有哪些函数可以用于探寻属性之间的相关性？ 
（3）尝试增加“每个家庭的房间数量”、“每个家庭的人口数”、“卧室/房间比例”三个属性。与房价中位数相关性最高的4个属性分别是？
4、准备数据。
（1）在此环节，需要对测试集中的数据做相关处理吗？
（2）你是如何处理缺失值的？
（3）为什么必须将ocean_proximity属性的文本类型转换为数值类型的？
（4）你是如何将ocean_proximity属性的文本类型转换为数值类型的？
（5）尝试增加3个新的重要特征：“每个家庭的房间数量”、“每个家庭的人口数”、“卧室/房间比例”
（6）你用到了特征缩放吗？你是如何实现特征缩放的？
（7）尝试使用流水线，来对数据做相关处理，包括缺失值处理，文本类型转换为数值类型，特征缩放，增加新的重要属性。（这是对提交的Python代码的要求）
5、研究模型。
（1）训练一个SVM（使用线性核函数）。并在训练集上评估其性能。在训练集上的RMSE是？
（2）利用10折交叉验证来评估其泛化性能。在验证集上的RMSE均值是？
6、微调模型。
（1）选择最佳超参。
a)利用网格搜索，从以下超参组合中选取最佳超参。其中，网格搜索的配置为“cv=5, scoring='neg_mean_squared_error', verbose=2”。最后得到的最佳超参是？最佳超参时，验证集上的RMSE为多少？
param_grid = [
        {'kernel': ['linear'], 'C': [10., 30., 100., 300., 1000., 3000., 10000., 30000.0]},
        {'kernel': ['rbf'], 'C': [1.0, 3.0, 10., 30., 100., 300., 1000.0],
         'gamma': [0.01, 0.03, 0.1, 0.3, 1.0, 3.0]},
    ]
b)利用随机搜索，寻找超参。
随机搜索的配置如下：“param_distributions=param_distribs,                              n_iter=50, cv=5, scoring='neg_mean_squared_error',                                 verbose=2, random_state=42) ”，其中：param_distribs = {
        'kernel': ['linear', 'rbf'],
        'C': reciprocal(20, 200000),
        'gamma': expon(scale=1.0),
}
    （2）在测试集上评估系统。其在测试集上的RMSE是？（提示：利用流水线的transform()方法对测试集做相关处理后，再进行评估）